@page "{id:int}"
@model RVPark.Pages.Admin.Reservations.UpdateModel
@{
    ViewData["Title"] = "Update Reservation";
}


<h2>Update Reservation</h2>

<form method="post">
    <input type="hidden" asp-for="ViewModel.Reservation.ReservationId" />

    <div>
        <label>Guest Name</label>
        <input value="@Model.ViewModel.GuestName" disabled />
    </div>

    <div>
        <label>RV Length</label>
        <input value="@Model.ViewModel.Rv.Length" disabled />
    </div>

    <div>
        <label>Start Date</label>
        <input asp-for="ViewModel.Reservation.StartDate" type="date" onchange="calculateUpdatedTotal()" />
    </div>

    <div>
        <label>End Date</label>
        <input asp-for="ViewModel.Reservation.EndDate" type="date" onchange="calculateUpdatedTotal()" />
    </div>

    <div>
        <label>Lot Type</label>
        <select id="lotTypeSelect">
            @foreach (var lotType in Model.ViewModel.LotTypes)
            {
                <option value="@lotType.Id">@lotType.Name - $@lotType.Rate/day</option>
            }
        </select>
    </div>

    <div>
        <label>Lot</label>
        <select asp-for="ViewModel.Reservation.LotId" id="lotSelect" onchange="calculateUpdatedTotal()">
            @foreach (var lot in Model.ViewModel.AvailableLots)
            {
                <option value="@lot.Id" data-rate="@lot.LotType.Rate">
                    @lot.Location (Type: @lot.LotType.Name)
                </option>
            }
        </select>
    </div>

    <div>
        <label>Duration</label>
        <input asp-for="ViewModel.Reservation.Duration" readonly />
    </div>

    <div>
        <label>Original Total</label>
        <input id="originalTotal" value="@Model.ViewModel.OriginalTotal.ToString("F2")" readonly />
    </div>

    <div>
        <label>Updated Total</label>
        <input id="updatedTotalField" readonly />
    </div>

    <div>
        <label>Balance Difference</label>
        <input id="balanceDifferenceField" readonly />
    </div>

    <div>
        <label>Status</label>
        <select asp-for="ViewModel.Reservation.Status">
            <option>Active</option>
            <option>Upcoming</option>
            <option>Completed</option>
            <option>Cancelled</option>
        </select>
    </div>

    <div>
        <label>Cancellation Reason</label>
        <input asp-for="ViewModel.Reservation.CancellationReason" />
    </div>

    <div>
        <label>Override Reason</label>
        <input asp-for="ViewModel.Reservation.OverrideReason" />
    </div>

    <button type="submit">Save Changes</button>
</form>

@section Scripts {
    <script src="~/js/reservation-update.js"></script>
}
